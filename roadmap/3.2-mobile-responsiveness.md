# 3.2 Mobile Responsiveness & PWA

## Overview
Optimize KubeVista for mobile and tablet devices with responsive design patterns, touch gestures, and Progressive Web App (PWA) capabilities for installation and offline support.

## Goals

1. **Responsive Design**: All pages work on phones (320px+), tablets (768px+), and desktops (1024px+)
2. **Touch Optimization**: Swipe gestures, larger tap targets, mobile-friendly interactions
3. **PWA Support**: Installable on mobile home screen, offline cache, app-like experience
4. **Performance**: Fast loading on mobile networks, optimized assets

## Current Issues

### Critical Issues
- Sidebar doesn't collapse on mobile (overlays content)
- Tables overflow on small screens
- Small tap targets (< 44px) on mobile
- Charts don't resize properly
- Topology graph not touch-friendly
- Modals fill entire screen (no scrolling)

### Minor Issues
- Long deployment names truncate poorly
- Too much padding on mobile
- Font sizes not optimized for mobile

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                  Responsive Breakpoints                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Mobile (xs):    320px - 599px   (Phone portrait)          │
│  Mobile (sm):    600px - 899px   (Phone landscape, tablet) │
│  Tablet (md):    900px - 1199px  (Tablet)                  │
│  Desktop (lg):   1200px - 1535px (Desktop)                 │
│  Desktop (xl):   1536px+         (Large desktop)           │
│                                                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                     Layout Strategy                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Mobile:    Bottom navigation + hamburger menu              │
│  Tablet:    Collapsible sidebar + bottom nav (optional)    │
│  Desktop:   Permanent sidebar + top navigation              │
│                                                              │
│  Tables:    Cards on mobile, tables on tablet/desktop       │
│  Charts:    Stack vertically on mobile, grid on desktop     │
│  Forms:     Full-width on mobile, max-width on desktop      │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

## Implementation Plan

### Phase 1: Responsive Sidebar & Navigation (4-6 hours)

#### 1.1 Mobile Navigation Component
**File**: `/app/components/layout/mobile-nav.tsx`
```typescript
'use client'

import { useState } from 'react'
import { usePathname, useRouter } from 'next/navigation'
import BottomNavigation from '@mui/material/BottomNavigation'
import BottomNavigationAction from '@mui/material/BottomNavigationAction'
import Paper from '@mui/material/Paper'
import DashboardIcon from '@mui/icons-material/Dashboard'
import LayersIcon from '@mui/icons-material/Layers'
import ViewInArIcon from '@mui/icons-material/ViewInAr'
import SettingsIcon from '@mui/icons-material/Settings'

export function MobileNav() {
  const pathname = usePathname()
  const router = useRouter()

  const routes = [
    { label: 'Dashboard', icon: <DashboardIcon />, path: '/dashboard' },
    { label: 'Deployments', icon: <LayersIcon />, path: '/deployments' },
    { label: 'Pods', icon: <ViewInArIcon />, path: '/pods' },
    { label: 'Settings', icon: <SettingsIcon />, path: '/settings' },
  ]

  const currentIndex = routes.findIndex(route => pathname.startsWith(route.path))

  return (
    <Paper
      sx={{
        position: 'fixed',
        bottom: 0,
        left: 0,
        right: 0,
        zIndex: 1100,
        display: { xs: 'block', md: 'none' }, // Only show on mobile
      }}
      elevation={3}
    >
      <BottomNavigation
        value={currentIndex}
        onChange={(_, newValue) => {
          router.push(routes[newValue].path)
        }}
        showLabels
      >
        {routes.map((route) => (
          <BottomNavigationAction
            key={route.path}
            label={route.label}
            icon={route.icon}
          />
        ))}
      </BottomNavigation>
    </Paper>
  )
}
```

#### 1.2 Update Sidebar for Mobile
**File**: `/app/components/layout/sidebar.tsx` (modify)
```typescript
'use client'

import { useState } from 'react'
import { usePathname } from 'next/navigation'
import Drawer from '@mui/material/Drawer'
import IconButton from '@mui/material/IconButton'
import MenuIcon from '@mui/icons-material/Menu'
import useMediaQuery from '@mui/material/useMediaQuery'
import { useTheme } from '@mui/material/styles'

export function Sidebar() {
  const theme = useTheme()
  const pathname = usePathname()
  const isMobile = useMediaQuery(theme.breakpoints.down('md'))
  const [mobileOpen, setMobileOpen] = useState(false)
  const [collapsed, setCollapsed] = useState(false)

  const handleDrawerToggle = () => {
    setMobileOpen(!mobileOpen)
  }

  // Sidebar content (existing)
  const drawerContent = (
    // ... existing sidebar content
  )

  return (
    <>
      {/* Mobile: Hamburger menu button */}
      {isMobile && (
        <IconButton
          color="inherit"
          edge="start"
          onClick={handleDrawerToggle}
          sx={{ position: 'fixed', top: 16, left: 16, zIndex: 1200 }}
        >
          <MenuIcon />
        </IconButton>
      )}

      {/* Mobile: Temporary drawer (swipe to close) */}
      <Drawer
        variant="temporary"
        open={mobileOpen}
        onClose={handleDrawerToggle}
        ModalProps={{ keepMounted: true }} // Better mobile performance
        sx={{
          display: { xs: 'block', md: 'none' },
          '& .MuiDrawer-paper': { width: 280 },
        }}
      >
        {drawerContent}
      </Drawer>

      {/* Desktop: Permanent drawer */}
      <Drawer
        variant="permanent"
        sx={{
          display: { xs: 'none', md: 'block' },
          width: collapsed ? 64 : 240,
          '& .MuiDrawer-paper': {
            width: collapsed ? 64 : 240,
            transition: theme.transitions.create('width', {
              easing: theme.transitions.easing.sharp,
              duration: theme.transitions.duration.enteringScreen,
            }),
          },
        }}
      >
        {drawerContent}
      </Drawer>
    </>
  )
}
```

#### 1.3 Update Main Layout
**File**: `/app/components/layout/main-layout.tsx` (modify)
```typescript
import Box from '@mui/material/Box'
import { Sidebar } from './sidebar'
import { MobileNav } from './mobile-nav'

export function MainLayout({ children }: { children: React.ReactNode }) {
  return (
    <Box sx={{ display: 'flex', minHeight: '100vh' }}>
      <Sidebar />

      <Box
        component="main"
        sx={{
          flexGrow: 1,
          p: { xs: 2, sm: 3 }, // Less padding on mobile
          ml: { xs: 0, md: '240px' }, // Sidebar width on desktop
          mb: { xs: '56px', md: 0 }, // Bottom nav height on mobile
          transition: 'margin-left 0.3s',
        }}
      >
        {children}
      </Box>

      {/* Mobile bottom navigation */}
      <MobileNav />
    </Box>
  )
}
```

**Tests**:
- E2E: Test sidebar on mobile (hamburger menu)
- E2E: Test bottom navigation
- Manual: Swipe to close drawer

---

### Phase 2: Responsive Tables & Cards (6-8 hours)

#### 2.1 Responsive Deployment List
**File**: `/app/deployments/page.tsx` (modify)
```typescript
'use client'

import { useDeployments } from '@/hooks/use-deployments'
import { useMediaQuery, useTheme } from '@mui/material'
import Box from '@mui/material/Box'
import { DeploymentTable } from '@/app/components/deployments/deployment-table'
import { DeploymentCards } from '@/app/components/deployments/deployment-cards'

export default function DeploymentsPage() {
  const theme = useTheme()
  const isMobile = useMediaQuery(theme.breakpoints.down('md'))
  const { data: deployments, isLoading } = useDeployments()

  if (isLoading) return <div>Loading...</div>

  return (
    <Box>
      {isMobile ? (
        <DeploymentCards deployments={deployments} />
      ) : (
        <DeploymentTable deployments={deployments} />
      )}
    </Box>
  )
}
```

#### 2.2 Mobile Card Component
**File**: `/app/components/deployments/deployment-cards.tsx`
```typescript
'use client'

import { useRouter } from 'next/navigation'
import Box from '@mui/material/Box'
import Card from '@mui/material/Card'
import CardContent from '@mui/material/CardContent'
import CardActionArea from '@mui/material/CardActionArea'
import Typography from '@mui/material/Typography'
import Chip from '@mui/material/Chip'
import LinearProgress from '@mui/material/LinearProgress'
import { StatusBadge } from '@/app/components/common/status-badge'
import { PendingPRBadge } from '@/app/components/github/pr-badge'

export function DeploymentCards({ deployments }: { deployments: Deployment[] }) {
  const router = useRouter()

  return (
    <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>
      {deployments.map((deployment) => (
        <Card key={deployment.name} elevation={2}>
          <CardActionArea
            onClick={() => router.push(`/deployments/${encodeURIComponent(deployment.name)}`)}
          >
            <CardContent>
              {/* Header */}
              <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', mb: 1 }}>
                <Typography variant="h6" component="div" noWrap sx={{ flex: 1 }}>
                  {deployment.name}
                </Typography>
                <StatusBadge status={deployment.status} size="small" />
              </Box>

              {/* Badges */}
              <Box sx={{ display: 'flex', gap: 1, mb: 2, flexWrap: 'wrap' }}>
                <Chip label={deployment.namespace} size="small" variant="outlined" />
                <PendingPRBadge
                  deploymentName={deployment.name}
                  namespace={deployment.namespace}
                />
              </Box>

              {/* Replicas */}
              <Box sx={{ mb: 1 }}>
                <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 0.5 }}>
                  <Typography variant="body2" color="text.secondary">
                    Replicas
                  </Typography>
                  <Typography variant="body2">
                    {deployment.replicas.ready}/{deployment.replicas.desired}
                  </Typography>
                </Box>
                <LinearProgress
                  variant="determinate"
                  value={(deployment.replicas.ready / deployment.replicas.desired) * 100}
                  color={deployment.replicas.ready === deployment.replicas.desired ? 'success' : 'warning'}
                />
              </Box>

              {/* Metadata */}
              <Box sx={{ display: 'flex', gap: 2, mt: 2 }}>
                <Typography variant="caption" color="text.secondary">
                  Age: {deployment.age}
                </Typography>
                {deployment.image && (
                  <Typography variant="caption" color="text.secondary" noWrap>
                    {deployment.image.split('/').pop()}
                  </Typography>
                )}
              </Box>
            </CardContent>
          </CardActionArea>
        </Card>
      ))}
    </Box>
  )
}
```

#### 2.3 Apply Same Pattern to Other Lists
- `/app/pods/page.tsx` → `PodCards` component
- `/app/services/page.tsx` → `ServiceCards` component
- `/app/configmaps/page.tsx` → `ConfigMapCards` component
- `/app/secrets/page.tsx` → `SecretCards` component

**Tests**:
- E2E: Verify cards display on mobile
- E2E: Tap card to navigate to details
- Visual regression tests

---

### Phase 3: Touch Gestures & Interactions (4-6 hours)

#### 3.1 Install Swipeable Library
```bash
npm install react-swipeable
```

#### 3.2 Swipe to Refresh
**File**: `/app/components/common/swipe-to-refresh.tsx`
```typescript
'use client'

import { useSwipeable } from 'react-swipeable'
import Box from '@mui/material/Box'
import CircularProgress from '@mui/material/CircularProgress'
import { useState } from 'react'

export function SwipeToRefresh({
  onRefresh,
  children,
}: {
  onRefresh: () => Promise<void>
  children: React.ReactNode
}) {
  const [isRefreshing, setIsRefreshing] = useState(false)
  const [pullDistance, setPullDistance] = useState(0)

  const handlers = useSwipeable({
    onSwipedDown: async (eventData) => {
      if (eventData.deltaY > 100 && window.scrollY === 0) {
        setIsRefreshing(true)
        await onRefresh()
        setIsRefreshing(false)
        setPullDistance(0)
      }
    },
    onSwiping: (eventData) => {
      if (eventData.dir === 'Down' && window.scrollY === 0) {
        setPullDistance(Math.min(eventData.deltaY, 100))
      }
    },
    trackMouse: false,
  })

  return (
    <Box {...handlers} sx={{ position: 'relative' }}>
      {/* Pull indicator */}
      {pullDistance > 0 && (
        <Box
          sx={{
            position: 'absolute',
            top: 0,
            left: '50%',
            transform: 'translateX(-50%)',
            transition: 'opacity 0.2s',
            opacity: pullDistance / 100,
          }}
        >
          {isRefreshing ? <CircularProgress size={24} /> : '↓'}
        </Box>
      )}

      {children}
    </Box>
  )
}
```

#### 3.3 Swipe to Delete (Lists)
**File**: `/app/components/common/swipeable-item.tsx`
```typescript
'use client'

import { useSwipeable } from 'react-swipeable'
import Box from '@mui/material/Box'
import IconButton from '@mui/material/IconButton'
import DeleteIcon from '@mui/icons-material/Delete'
import { useState } from 'react'

export function SwipeableItem({
  children,
  onDelete,
}: {
  children: React.ReactNode
  onDelete?: () => void
}) {
  const [offset, setOffset] = useState(0)

  const handlers = useSwipeable({
    onSwipedLeft: () => {
      if (onDelete) {
        setOffset(-80) // Reveal delete button
      }
    },
    onSwipedRight: () => {
      setOffset(0) // Hide delete button
    },
    onSwiping: (eventData) => {
      if (eventData.dir === 'Left' && onDelete) {
        setOffset(Math.max(eventData.deltaX, -80))
      } else if (eventData.dir === 'Right') {
        setOffset(Math.min(eventData.deltaX, 0))
      }
    },
    trackMouse: false,
  })

  return (
    <Box sx={{ position: 'relative', overflow: 'hidden' }}>
      {/* Delete button (hidden behind) */}
      {onDelete && (
        <Box
          sx={{
            position: 'absolute',
            right: 0,
            top: 0,
            bottom: 0,
            width: 80,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            bgcolor: 'error.main',
          }}
        >
          <IconButton onClick={onDelete} sx={{ color: 'white' }}>
            <DeleteIcon />
          </IconButton>
        </Box>
      )}

      {/* Main content */}
      <Box
        {...handlers}
        sx={{
          transform: `translateX(${offset}px)`,
          transition: 'transform 0.3s',
          bgcolor: 'background.paper',
        }}
      >
        {children}
      </Box>
    </Box>
  )
}
```

#### 3.4 Larger Tap Targets
Update all buttons, icons, and clickable elements:
```typescript
// Minimum 44x44px touch target (iOS HIG)
<IconButton
  size="medium" // At least medium (40px), or large (48px)
  sx={{ minWidth: 44, minHeight: 44 }}
>
  <DeleteIcon />
</IconButton>
```

**Tests**:
- Manual: Test swipe gestures on real device
- E2E: Simulate touch events with Playwright

---

### Phase 4: Responsive Charts & Topology (6-8 hours)

#### 4.1 Responsive Chart Container
**File**: `/app/components/common/responsive-chart.tsx`
```typescript
'use client'

import { useEffect, useState } from 'react'
import Box from '@mui/material/Box'
import { useMediaQuery, useTheme } from '@mui/material'

export function ResponsiveChart({ children }: { children: React.ReactNode }) {
  const theme = useTheme()
  const isMobile = useMediaQuery(theme.breakpoints.down('sm'))
  const [chartHeight, setChartHeight] = useState(300)

  useEffect(() => {
    setChartHeight(isMobile ? 200 : 300)
  }, [isMobile])

  return (
    <Box
      sx={{
        width: '100%',
        height: chartHeight,
        '& .recharts-wrapper': {
          width: '100% !important',
          height: '100% !important',
        },
      }}
    >
      {children}
    </Box>
  )
}
```

#### 4.2 Update Metrics Charts
**File**: `/app/components/metrics/resource-usage-chart.tsx` (modify)
```typescript
import { ResponsiveChart } from '@/app/components/common/responsive-chart'
import { useMediaQuery, useTheme } from '@mui/material'

export function ResourceUsageChart({ data }: { data: MetricsData }) {
  const theme = useTheme()
  const isMobile = useMediaQuery(theme.breakpoints.down('sm'))

  return (
    <ResponsiveChart>
      <BarChart data={data}>
        <XAxis
          dataKey="name"
          angle={isMobile ? -45 : 0} // Rotate labels on mobile
          textAnchor={isMobile ? 'end' : 'middle'}
          height={isMobile ? 80 : 30}
          tick={{ fontSize: isMobile ? 10 : 12 }}
        />
        <YAxis tick={{ fontSize: isMobile ? 10 : 12 }} />
        <Tooltip />
        <Bar dataKey="cpu" fill="#8884d8" />
        <Bar dataKey="memory" fill="#82ca9d" />
      </BarChart>
    </ResponsiveChart>
  )
}
```

#### 4.3 Touch-Friendly Topology
**File**: `/app/topology/page.tsx` (modify)
```typescript
'use client'

import { ReactFlow } from '@xyflow/react'
import { useMediaQuery, useTheme } from '@mui/material'

export default function TopologyPage() {
  const theme = useTheme()
  const isMobile = useMediaQuery(theme.breakpoints.down('md'))

  return (
    <ReactFlow
      // ... existing props
      panOnScroll={!isMobile} // Disable on mobile (conflicts with page scroll)
      panOnDrag={!isMobile} // Disable on mobile
      zoomOnPinch={isMobile} // Enable pinch-to-zoom on mobile
      minZoom={isMobile ? 0.5 : 0.1}
      maxZoom={isMobile ? 2 : 4}
      defaultViewport={{ x: 0, y: 0, zoom: isMobile ? 0.7 : 1 }}
      nodesDraggable={!isMobile} // Prevent accidental node drag on mobile
    >
      {/* ... */}
    </ReactFlow>
  )
}
```

**Tests**:
- Manual: Test charts on mobile (resize window)
- Manual: Test topology pinch-to-zoom on tablet

---

### Phase 5: PWA Implementation (6-8 hours)

#### 5.1 Install next-pwa
```bash
npm install next-pwa
```

#### 5.2 Update Next.js Config
**File**: `/next.config.mjs` (modify)
```javascript
import withPWA from 'next-pwa'

/** @type {import('next').NextConfig} */
const nextConfig = {
  // ... existing config
}

export default withPWA({
  dest: 'public',
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === 'development', // Disable in dev
})(nextConfig)
```

#### 5.3 Create Manifest
**File**: `/public/manifest.json`
```json
{
  "name": "KubeVista - Kubernetes Dashboard",
  "short_name": "KubeVista",
  "description": "Modern Kubernetes Dashboard",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#6366F1",
  "orientation": "portrait-primary",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icon-512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ]
}
```

#### 5.4 Add Manifest to HTML
**File**: `/app/layout.tsx` (modify)
```typescript
export const metadata = {
  manifest: '/manifest.json',
  themeColor: '#6366F1',
  appleWebApp: {
    capable: true,
    statusBarStyle: 'default',
    title: 'KubeVista',
  },
}
```

#### 5.5 Create Icons
Generate PWA icons:
- 192x192px
- 512x512px
- Apple touch icons (180x180px)

Use tools like [PWA Asset Generator](https://github.com/elegantapp/pwa-asset-generator)

```bash
npx pwa-asset-generator public/logo.svg public/icons
```

#### 5.6 Service Worker Caching Strategy
**File**: `/public/sw.js` (auto-generated by next-pwa, customize if needed)
```javascript
// Cache strategies:
// - Static assets: Cache first
// - API calls: Network first, fallback to cache
// - Images: Cache first, with expiration

self.addEventListener('fetch', (event) => {
  const { request } = event

  // API calls: Network first
  if (request.url.includes('/api/')) {
    event.respondWith(
      fetch(request)
        .then((response) => {
          const cache = await caches.open('api-cache')
          cache.put(request, response.clone())
          return response
        })
        .catch(() => caches.match(request))
    )
  }

  // Static assets: Cache first
  else {
    event.respondWith(
      caches.match(request)
        .then((response) => response || fetch(request))
    )
  }
})
```

#### 5.7 Install Prompt
**File**: `/app/components/pwa/install-prompt.tsx`
```typescript
'use client'

import { useEffect, useState } from 'react'
import Button from '@mui/material/Button'
import Snackbar from '@mui/material/Snackbar'
import Alert from '@mui/material/Alert'
import InstallMobileIcon from '@mui/icons-material/InstallMobile'

export function InstallPrompt() {
  const [deferredPrompt, setDeferredPrompt] = useState<any>(null)
  const [showPrompt, setShowPrompt] = useState(false)

  useEffect(() => {
    const handler = (e: Event) => {
      e.preventDefault()
      setDeferredPrompt(e)
      setShowPrompt(true)
    }

    window.addEventListener('beforeinstallprompt', handler)

    return () => window.removeEventListener('beforeinstallprompt', handler)
  }, [])

  const handleInstall = async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt()
      const { outcome } = await deferredPrompt.userChoice
      console.log(`User ${outcome} the install prompt`)
      setDeferredPrompt(null)
      setShowPrompt(false)
    }
  }

  return (
    <Snackbar
      open={showPrompt}
      onClose={() => setShowPrompt(false)}
      anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}
    >
      <Alert
        severity="info"
        action={
          <Button color="inherit" size="small" onClick={handleInstall}>
            Install
          </Button>
        }
        icon={<InstallMobileIcon />}
      >
        Install KubeVista for quick access
      </Alert>
    </Snackbar>
  )
}
```

#### 5.8 Add to Root Layout
**File**: `/app/layout.tsx` (modify)
```typescript
import { InstallPrompt } from '@/app/components/pwa/install-prompt'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <InstallPrompt />
      </body>
    </html>
  )
}
```

**Tests**:
- Lighthouse PWA audit (score > 90)
- Manual: Install on iPhone/Android
- Test offline mode

---

### Phase 6: Typography & Spacing (3-4 hours)

#### 6.1 Mobile-Optimized Typography
**File**: `/app/theme.tsx` (modify)
```typescript
import { createTheme } from '@mui/material/styles'

export const theme = createTheme({
  typography: {
    h4: {
      fontSize: '1.75rem', // Desktop
      '@media (max-width:600px)': {
        fontSize: '1.5rem', // Mobile
      },
    },
    h5: {
      fontSize: '1.5rem',
      '@media (max-width:600px)': {
        fontSize: '1.25rem',
      },
    },
    h6: {
      fontSize: '1.25rem',
      '@media (max-width:600px)': {
        fontSize: '1.1rem',
      },
    },
    body1: {
      fontSize: '1rem',
      '@media (max-width:600px)': {
        fontSize: '0.95rem',
      },
    },
    body2: {
      fontSize: '0.875rem',
      '@media (max-width:600px)': {
        fontSize: '0.85rem',
      },
    },
  },
  spacing: 8, // Default 8px
  // Mobile: Reduce padding/margins
  components: {
    MuiContainer: {
      styleOverrides: {
        root: {
          paddingLeft: 16,
          paddingRight: 16,
          '@media (max-width:600px)': {
            paddingLeft: 8,
            paddingRight: 8,
          },
        },
      },
    },
  },
})
```

#### 6.2 Responsive Padding/Margins
Use Material-UI responsive spacing:
```typescript
<Box sx={{ p: { xs: 1, sm: 2, md: 3 } }}>
  {/* 8px on mobile, 16px on tablet, 24px on desktop */}
</Box>

<Box sx={{ mb: { xs: 2, md: 4 } }}>
  {/* 16px margin-bottom on mobile, 32px on desktop */}
</Box>
```

**Tests**:
- Visual regression: Compare mobile/desktop screenshots
- Manual: Test on real devices (iPhone, Android)

---

### Phase 7: Performance Optimization (4-6 hours)

#### 7.1 Image Optimization
```typescript
// Use Next.js Image component
import Image from 'next/image'

<Image
  src="/logo.svg"
  alt="KubeVista"
  width={200}
  height={200}
  priority // Load above the fold
/>
```

#### 7.2 Code Splitting
```typescript
// Lazy load heavy components
import dynamic from 'next/dynamic'

const TopologyGraph = dynamic(() => import('@/app/components/topology/topology-graph'), {
  loading: () => <CircularProgress />,
  ssr: false, // Don't SSR heavy visualizations
})
```

#### 7.3 Reduce Bundle Size
```bash
# Analyze bundle
npm run build
npx @next/bundle-analyzer
```

Remove unused dependencies, tree-shake Material-UI imports.

#### 7.4 Mobile-Specific Optimizations
- Reduce chart refresh rate on mobile (60s vs 30s)
- Paginate long lists (10 items per page on mobile)
- Defer non-critical JS loading

**Tests**:
- Lighthouse performance audit (score > 90)
- Test on slow 3G network

---

## Testing Strategy

### Manual Testing
- Test on real devices: iPhone (Safari), Android (Chrome)
- Test on tablets: iPad
- Test landscape and portrait orientations
- Test offline mode (airplane mode)
- Test install prompt

### Automated Testing
- **Vitest**: Component tests with mobile viewport
- **Playwright**: E2E tests with mobile emulation
  ```typescript
  test.use({ viewport: { width: 375, height: 667 } }) // iPhone SE
  ```
- **Visual Regression**: Percy/Chromatic for screenshot comparison

### Lighthouse Audits
- PWA score > 90
- Performance score > 90 on mobile
- Accessibility score > 90

## Time Estimate

| Phase | Hours |
|-------|-------|
| Phase 1: Responsive Sidebar & Navigation | 4-6 |
| Phase 2: Responsive Tables & Cards | 6-8 |
| Phase 3: Touch Gestures & Interactions | 4-6 |
| Phase 4: Responsive Charts & Topology | 6-8 |
| Phase 5: PWA Implementation | 6-8 |
| Phase 6: Typography & Spacing | 3-4 |
| Phase 7: Performance Optimization | 4-6 |
| **Total** | **33-46 hours** |

## Dependencies

```bash
npm install react-swipeable next-pwa
```

## Responsive Breakpoints Reference

```typescript
// Material-UI breakpoints
{
  xs: 0,      // Phone
  sm: 600,    // Tablet
  md: 900,    // Small laptop
  lg: 1200,   // Desktop
  xl: 1536,   // Large desktop
}

// Usage
sx={{ display: { xs: 'none', md: 'block' } }} // Hide on mobile, show on desktop
sx={{ width: { xs: '100%', md: '50%' } }}     // Full width on mobile, half on desktop
```

## Future Enhancements

1. **Offline Data Sync**: Queue mutations when offline, sync when online
2. **Push Notifications**: Alert users about pod failures via Web Push API
3. **Haptic Feedback**: Vibration on swipe actions (navigator.vibrate)
4. **Voice Commands**: "Hey KubeVista, show me pods in production"
5. **Dark Mode Auto-Switch**: Follow system preference on mobile
6. **Biometric Auth**: Use Web Authentication API for fingerprint/face unlock
