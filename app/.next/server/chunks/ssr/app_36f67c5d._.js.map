{"version":3,"sources":["../../../../../app/lib/hooks/use-statefulsets.ts","../../../../../app/app/statefulsets/page.tsx","../../../../../app/app/components/statefulsets/statefulset-card.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query'\nimport { useModeStore } from '@/lib/core/store'\nimport { generateMockStatefulSets } from '@/lib/mocks/data'\nimport type { StatefulSet } from '@/types/kubernetes'\n\n/**\n * Hook to fetch all statefulsets\n */\nexport function useStatefulSets() {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<StatefulSet[]>({\n    queryKey: ['statefulsets', mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 300))\n        return generateMockStatefulSets()\n      }\n\n      // Real mode: fetch from API route (server-side)\n      const response = await fetch(\n        `/api/statefulsets?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`\n      )\n      if (!response.ok) throw new Error('Failed to fetch statefulsets')\n      return response.json()\n    },\n  })\n}\n\n/**\n * Hook to fetch a single statefulset by name\n */\nexport function useStatefulSet(name: string) {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<StatefulSet>({\n    queryKey: ['statefulset', name, mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 200))\n        const statefulsets = generateMockStatefulSets()\n        const statefulset = statefulsets.find((sts) => sts.name === name)\n        if (!statefulset) throw new Error('StatefulSet not found')\n        return statefulset\n      }\n\n      // Real mode: fetch from API route (server-side)\n      const response = await fetch(\n        `/api/statefulsets/${name}?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`\n      )\n      if (!response.ok) throw new Error('Failed to fetch statefulset')\n      return response.json()\n    },\n    enabled: !!name && (mode === 'demo' || !!namespace),\n  })\n}\n","'use client'\n\nimport Typography from '@mui/material/Typography'\nimport IconButton from '@mui/material/IconButton'\nimport StorageIcon from '@mui/icons-material/Storage'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { useState, useEffect } from 'react'\nimport { useSearchParams } from 'next/navigation'\nimport { useNavigateTo } from '@/lib/hooks/use-navigate-to'\nimport { useStatefulSets } from '@/lib/hooks/use-statefulsets'\nimport { StatusBadge } from '@/app/components/common/status-badge'\nimport { ResourceListView, TableColumn } from '@/app/components/common/resource-list-view'\nimport { StatefulSetCard } from '@/app/components/statefulsets/statefulset-card'\nimport type { StatefulSet, DeploymentStatus } from '@/types/kubernetes'\n\nexport default function StatefulSetsPage() {\n  const navigateTo = useNavigateTo()\n  const searchParams = useSearchParams()\n  const [statusFilter, setStatusFilter] = useState<DeploymentStatus | ''>('')\n  const { data: statefulsets, isLoading, error, refetch } = useStatefulSets()\n\n  // Set filter from URL on mount\n  useEffect(() => {\n    const status = searchParams.get('status')\n    if (status && (status === 'Healthy' || status === 'Degraded' || status === 'Not Ready')) {\n      setStatusFilter(status as DeploymentStatus)\n    }\n  }, [searchParams])\n\n  const columns: TableColumn<StatefulSet>[] = [\n    {\n      field: 'name',\n      label: 'Name',\n      render: (sts) => (\n        <Typography variant=\"body2\" fontWeight=\"medium\">\n          {sts.name}\n        </Typography>\n      ),\n    },\n    {\n      field: 'status',\n      label: 'Status',\n      render: (sts) => <StatusBadge status={sts.status} />,\n    },\n    {\n      field: 'replicas',\n      label: 'Replicas',\n      align: 'center',\n      render: (sts) => `${sts.replicas.ready}/${sts.replicas.desired}`,\n      customSortFn: (a, b, order) => {\n        const aVal = a.replicas.ready\n        const bVal = b.replicas.ready\n        return order === 'asc' ? aVal - bVal : bVal - aVal\n      },\n    },\n    {\n      field: 'current',\n      label: 'Current',\n      align: 'center',\n      render: (sts) => sts.replicas.current,\n      customSortFn: (a, b, order) => {\n        const aVal = a.replicas.current\n        const bVal = b.replicas.current\n        return order === 'asc' ? aVal - bVal : bVal - aVal\n      },\n    },\n    {\n      field: 'updated',\n      label: 'Updated',\n      align: 'center',\n      render: (sts) => sts.replicas.updated,\n      customSortFn: (a, b, order) => {\n        const aVal = a.replicas.updated\n        const bVal = b.replicas.updated\n        return order === 'asc' ? aVal - bVal : bVal - aVal\n      },\n    },\n    {\n      field: 'age',\n      label: 'Age',\n    },\n    {\n      field: 'serviceName',\n      label: 'Service',\n    },\n    {\n      field: 'actions',\n      label: 'Actions',\n      align: 'right',\n      sortable: false,\n      render: (sts) => (\n        <IconButton\n          size=\"small\"\n          onClick={(e) => {\n            e.stopPropagation()\n            navigateTo(`/statefulsets/${sts.name}`)\n          }}\n        >\n          <VisibilityIcon fontSize=\"small\" />\n        </IconButton>\n      ),\n    },\n  ]\n\n  return (\n    <ResourceListView\n      title=\"StatefulSets\"\n      resourceName=\"statefulset\"\n      resourceNamePlural=\"statefulsets\"\n      icon={StorageIcon}\n      data={statefulsets}\n      isLoading={isLoading}\n      error={error}\n      refetch={refetch}\n      searchPlaceholder=\"Search statefulsets...\"\n      searchFilter={(sts, query) =>\n        sts.name.toLowerCase().includes(query.toLowerCase())\n      }\n      customFilter={\n        statusFilter\n          ? (sts) => sts.status === statusFilter\n          : undefined\n      }\n      filters={[\n        {\n          label: 'Status',\n          value: statusFilter,\n          options: [\n            { label: 'All Statuses', value: '' },\n            { label: 'Healthy', value: 'Healthy' },\n            { label: 'Degraded', value: 'Degraded' },\n            { label: 'Not Ready', value: 'Not Ready' },\n          ],\n          onChange: (value) => setStatusFilter(value as DeploymentStatus | ''),\n        },\n      ]}\n      columns={columns}\n      defaultSortField=\"name\"\n      defaultSortOrder=\"asc\"\n      getRowKey={(sts) => sts.name}\n      onRowClick={(sts) => navigateTo(`/statefulsets/${sts.name}`)}\n      renderCard={(sts, onClick) => (\n        <StatefulSetCard statefulSet={sts} onClick={onClick} />\n      )}\n      emptyStateDescription=\"There are no statefulsets in this namespace.\"\n    />\n  )\n}\n","import Box from '@mui/material/Box'\nimport Typography from '@mui/material/Typography'\nimport StorageIcon from '@mui/icons-material/Storage'\nimport { StatusBadge } from '@/app/components/common/status-badge'\nimport { ResourceCard } from '@/app/components/common/resource-card'\nimport type { StatefulSet } from '@/types/kubernetes'\n\ninterface StatefulSetCardProps {\n  statefulSet: StatefulSet\n  onClick?: () => void\n}\n\nexport function StatefulSetCard({ statefulSet, onClick }: StatefulSetCardProps) {\n  const resourceColor = '#7C3AED' // Purple for statefulsets\n\n  return (\n    <ResourceCard\n      name={statefulSet.name}\n      resourceType=\"StatefulSet\"\n      resourceColor={resourceColor}\n      icon={StorageIcon}\n      onClick={onClick}\n      statusBadge={<StatusBadge status={statefulSet.status} />}\n      metrics={\n        <Box sx={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 1.5 }}>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Replicas\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={700}>\n              {statefulSet.replicas.ready}/{statefulSet.replicas.desired}\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Updated\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={700}>\n              {statefulSet.replicas.updated}\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Service\n            </Typography>\n            <Typography variant=\"body2\" fontWeight={600} sx={{\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap'\n            }}>\n              {statefulSet.serviceName || '-'}\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              PVCs\n            </Typography>\n            <Typography variant=\"body2\" fontWeight={600}>\n              {statefulSet.persistentVolumeClaims.length || 0}\n            </Typography>\n          </Box>\n        </Box>\n      }\n      footer={\n        <Typography variant=\"caption\" color=\"text.secondary\">\n          Age: {statefulSet.age}\n        </Typography>\n      }\n    />\n  )\n}\n"],"names":[],"mappings":"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"}