{"version":3,"sources":["../../../../../app/lib/hooks/use-jobs.ts","../../../../../app/app/jobs/page.tsx","../../../../../app/app/components/jobs/job-card.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query'\nimport { useModeStore } from '@/lib/core/store'\nimport { generateMockJobs } from '@/lib/mocks/data'\nimport type { Job } from '@/types/kubernetes'\n\nexport function useJobs() {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<Job[]>({\n    queryKey: ['jobs', mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 300))\n        return generateMockJobs()\n      }\n\n      const response = await fetch(`/api/jobs?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`)\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to fetch jobs')\n      }\n      return response.json()\n    },\n    enabled: mode === 'demo' || !!namespace,\n  })\n}\n\nexport function useJob(name: string) {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<Job>({\n    queryKey: ['jobs', name, mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 200))\n        const jobs = generateMockJobs()\n        const job = jobs.find((j) => j.name === name)\n        if (!job) throw new Error('Job not found')\n        return job\n      }\n\n      const response = await fetch(`/api/jobs/${name}?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`)\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to fetch job')\n      }\n      return response.json()\n    },\n    enabled: (mode === 'demo' || !!namespace) && !!name,\n  })\n}\n","'use client'\n\nimport Typography from '@mui/material/Typography'\nimport IconButton from '@mui/material/IconButton'\nimport WorkIcon from '@mui/icons-material/Work'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { useState } from 'react'\nimport { useNavigateTo } from '@/lib/hooks/use-navigate-to'\nimport { useJobs } from '@/lib/hooks/use-jobs'\nimport { StatusBadge } from '@/app/components/common/status-badge'\nimport { JobCard } from '@/app/components/jobs/job-card'\nimport { ResourceListView, TableColumn } from '@/app/components/common/resource-list-view'\nimport type { Job, JobStatus } from '@/types/kubernetes'\n\nexport default function JobsPage() {\n  const navigateTo = useNavigateTo()\n  const [statusFilter, setStatusFilter] = useState<JobStatus | ''>('')\n  const { data: jobs, isLoading, error, refetch } = useJobs()\n\n  const columns: TableColumn<Job>[] = [\n    {\n      field: 'name',\n      label: 'Name',\n      render: (job) => (\n        <Typography variant=\"body2\" fontWeight=\"medium\">\n          {job.name}\n        </Typography>\n      ),\n    },\n    {\n      field: 'status',\n      label: 'Status',\n      render: (job) => <StatusBadge status={job.status} />,\n    },\n    {\n      field: 'completions',\n      label: 'Completions',\n      align: 'center',\n      render: (job) => `${job.succeeded}/${job.completions}`,\n    },\n    {\n      field: 'duration',\n      label: 'Duration',\n      render: (job) => job.duration || 'N/A',\n    },\n    {\n      field: 'active',\n      label: 'Active',\n      align: 'center',\n    },\n    {\n      field: 'failed',\n      label: 'Failed',\n      align: 'center',\n    },\n    {\n      field: 'age',\n      label: 'Age',\n    },\n    {\n      field: 'actions',\n      label: 'Actions',\n      align: 'right',\n      sortable: false,\n      render: (job) => (\n        <IconButton\n          size=\"small\"\n          onClick={(e) => {\n            e.stopPropagation()\n            navigateTo(`/jobs/${job.name}`)\n          }}\n        >\n          <VisibilityIcon fontSize=\"small\" />\n        </IconButton>\n      ),\n    },\n  ]\n\n  return (\n    <ResourceListView\n      title=\"Jobs\"\n      resourceName=\"job\"\n      resourceNamePlural=\"jobs\"\n      icon={WorkIcon}\n      data={jobs}\n      isLoading={isLoading}\n      error={error}\n      refetch={refetch}\n      searchPlaceholder=\"Search jobs...\"\n      searchFilter={(job, query) => job.name.toLowerCase().includes(query.toLowerCase())}\n      customFilter={statusFilter ? (job) => job.status === statusFilter : undefined}\n      filters={[\n        {\n          label: 'Status',\n          value: statusFilter,\n          options: [\n            { label: 'All Statuses', value: '' },\n            { label: 'Running', value: 'Running' },\n            { label: 'Succeeded', value: 'Succeeded' },\n            { label: 'Failed', value: 'Failed' },\n          ],\n          onChange: (value) => setStatusFilter(value as JobStatus | ''),\n        },\n      ]}\n      columns={columns}\n      defaultSortField=\"name\"\n      defaultSortOrder=\"asc\"\n      getRowKey={(job) => job.name}\n      onRowClick={(job) => navigateTo(`/jobs/${job.name}`)}\n      renderCard={(job, onClick) => <JobCard job={job} onClick={onClick} />}\n      emptyStateDescription=\"There are no jobs in this namespace. Create a job to run batch tasks.\"\n    />\n  )\n}\n","import Box from '@mui/material/Box'\nimport Typography from '@mui/material/Typography'\nimport WorkIcon from '@mui/icons-material/Work'\nimport { StatusBadge } from '@/app/components/common/status-badge'\nimport { ResourceCard } from '@/app/components/common/resource-card'\nimport type { Job } from '@/types/kubernetes'\n\ninterface JobCardProps {\n  job: Job\n  onClick?: () => void\n}\n\nexport function JobCard({ job, onClick }: JobCardProps) {\n  const resourceColor = '#FF9800' // Orange for jobs\n\n  return (\n    <ResourceCard\n      name={job.name}\n      resourceType=\"Job\"\n      resourceColor={resourceColor}\n      icon={WorkIcon}\n      onClick={onClick}\n      statusBadge={<StatusBadge status={job.status} />}\n      metrics={\n        <Box sx={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 1.5 }}>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Succeeded\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={700}>\n              {job.succeeded}/{job.completions}\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Failed\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={700}>\n              {job.failed}\n            </Typography>\n          </Box>\n        </Box>\n      }\n      footer={\n        <Typography variant=\"caption\" color=\"text.secondary\">\n          Age: {job.age}\n        </Typography>\n      }\n    />\n  )\n}\n"],"names":[],"mappings":"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"}