{"version":3,"sources":["../../../../../app/lib/hooks/use-cronjobs.ts","../../../../../app/app/cronjobs/page.tsx","../../../../../app/app/components/cronjobs/cronjob-card.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query'\nimport { useModeStore } from '@/lib/core/store'\nimport { generateMockCronJobs } from '@/lib/mocks/data'\nimport type { CronJob } from '@/types/kubernetes'\n\nexport function useCronJobs() {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<CronJob[]>({\n    queryKey: ['cronjobs', mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 300))\n        return generateMockCronJobs()\n      }\n\n      const response = await fetch(`/api/cronjobs?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`)\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to fetch cronjobs')\n      }\n      return response.json()\n    },\n    enabled: mode === 'demo' || !!namespace,\n  })\n}\n\nexport function useCronJob(name: string) {\n  const mode = useModeStore((state) => state.mode)\n  const namespace = useModeStore((state) => state.selectedNamespace)\n  const selectedContext = useModeStore((state) => state.selectedContext)\n\n  return useQuery<CronJob>({\n    queryKey: ['cronjobs', name, mode, namespace, selectedContext?.name || ''],\n    queryFn: async () => {\n      if (mode === 'demo') {\n        await new Promise((resolve) => setTimeout(resolve, 200))\n        const cronjobs = generateMockCronJobs()\n        const cronjob = cronjobs.find((cj) => cj.name === name)\n        if (!cronjob) throw new Error('CronJob not found')\n        return cronjob\n      }\n\n      const response = await fetch(`/api/cronjobs/${name}?namespace=${encodeURIComponent(namespace)}&context=${encodeURIComponent(selectedContext?.name || '')}`)\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to fetch cronjob')\n      }\n      return response.json()\n    },\n    enabled: (mode === 'demo' || !!namespace) && !!name,\n  })\n}\n","'use client'\n\nimport Typography from '@mui/material/Typography'\nimport IconButton from '@mui/material/IconButton'\nimport ScheduleIcon from '@mui/icons-material/Schedule'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { StatusBadge } from '@/app/components/common/status-badge'\nimport { useNavigateTo } from '@/lib/hooks/use-navigate-to'\nimport { useCronJobs } from '@/lib/hooks/use-cronjobs'\nimport { CronJobCard } from '@/app/components/cronjobs/cronjob-card'\nimport { ResourceListView, TableColumn } from '@/app/components/common/resource-list-view'\nimport type { CronJob } from '@/types/kubernetes'\n\nexport default function CronJobsPage() {\n  const navigateTo = useNavigateTo()\n  const { data: cronjobs, isLoading, error, refetch } = useCronJobs()\n\n  const columns: TableColumn<CronJob>[] = [\n    {\n      field: 'name',\n      label: 'Name',\n      render: (cronJob) => (\n        <Typography variant=\"body2\" fontWeight=\"medium\">\n          {cronJob.name}\n        </Typography>\n      ),\n    },\n    {\n      field: 'schedule',\n      label: 'Schedule',\n      render: (cronJob) => (\n        <Typography variant=\"body2\" sx={{ fontFamily: 'monospace' }}>\n          {cronJob.schedule}\n        </Typography>\n      ),\n    },\n    {\n      field: 'suspend',\n      label: 'Status',\n      render: (cronJob) => (\n        <StatusBadge\n          label={cronJob.suspend ? 'Suspended' : 'Active'}\n          size=\"small\"\n          color={cronJob.suspend ? 'warning' : 'success'}\n        />\n      ),\n    },\n    {\n      field: 'active',\n      label: 'Active',\n      align: 'center',\n    },\n    {\n      field: 'lastSchedule',\n      label: 'Last Schedule',\n      render: (cronJob) => cronJob.lastSchedule || 'Never',\n    },\n    {\n      field: 'age',\n      label: 'Age',\n    },\n    {\n      field: 'actions',\n      label: 'Actions',\n      align: 'right',\n      sortable: false,\n      render: (cronJob) => (\n        <IconButton\n          size=\"small\"\n          onClick={(e) => {\n            e.stopPropagation()\n            navigateTo(`/cronjobs/${cronJob.name}`)\n          }}\n        >\n          <VisibilityIcon fontSize=\"small\" />\n        </IconButton>\n      ),\n    },\n  ]\n\n  return (\n    <ResourceListView\n      title=\"CronJobs\"\n      resourceName=\"cronjob\"\n      resourceNamePlural=\"cronjobs\"\n      icon={ScheduleIcon}\n      data={cronjobs}\n      isLoading={isLoading}\n      error={error}\n      refetch={refetch}\n      searchPlaceholder=\"Search cronjobs...\"\n      searchFilter={(cronJob, query) =>\n        cronJob.name.toLowerCase().includes(query.toLowerCase())\n      }\n      columns={columns}\n      defaultSortField=\"name\"\n      defaultSortOrder=\"asc\"\n      getRowKey={(cronJob) => cronJob.name}\n      onRowClick={(cronJob) => navigateTo(`/cronjobs/${cronJob.name}`)}\n      renderCard={(cronJob, onClick) => <CronJobCard cronJob={cronJob} onClick={onClick} />}\n      emptyStateDescription=\"There are no cronjobs in this namespace. Create a cronjob to schedule recurring tasks.\"\n    />\n  )\n}\n","import Box from '@mui/material/Box'\nimport Typography from '@mui/material/Typography'\nimport Chip from '@mui/material/Chip'\nimport ScheduleIcon from '@mui/icons-material/Schedule'\nimport { ResourceCard } from '@/app/components/common/resource-card'\nimport type { CronJob } from '@/types/kubernetes'\n\ninterface CronJobCardProps {\n  cronJob: CronJob\n  onClick?: () => void\n}\n\nexport function CronJobCard({ cronJob, onClick }: CronJobCardProps) {\n  const resourceColor = '#4CAF50' // Green for cronjobs\n\n  return (\n    <ResourceCard\n      name={cronJob.name}\n      resourceType=\"CronJob\"\n      resourceColor={resourceColor}\n      icon={ScheduleIcon}\n      onClick={onClick}\n      statusBadge={\n        <Chip\n          label={cronJob.suspend ? 'Suspended' : 'Active'}\n          size=\"small\"\n          sx={{\n            fontWeight: 600,\n            fontSize: '0.75rem',\n            height: 24,\n            borderRadius: '6px',\n            backgroundColor: (theme) =>\n              cronJob.suspend\n                ? theme.palette.mode === 'dark'\n                  ? 'rgba(255, 152, 0, 0.2)'\n                  : 'rgba(255, 152, 0, 0.15)'\n                : theme.palette.mode === 'dark'\n                ? 'rgba(76, 175, 80, 0.2)'\n                : 'rgba(76, 175, 80, 0.15)',\n            color: (theme) =>\n              cronJob.suspend\n                ? theme.palette.mode === 'dark'\n                  ? '#FF9F0A'\n                  : '#FF9500'\n                : theme.palette.mode === 'dark'\n                ? '#4CAF50'\n                : '#2E7D32',\n          }}\n        />\n      }\n      metrics={\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Schedule\n            </Typography>\n            <Typography\n              variant=\"body2\"\n              fontWeight={600}\n              sx={{\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n                fontFamily: 'monospace',\n              }}\n            >\n              {cronJob.schedule}\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 0.5 }}>\n              Active Jobs\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={700}>\n              {cronJob.active}\n            </Typography>\n          </Box>\n        </Box>\n      }\n      footer={\n        <Typography variant=\"caption\" color=\"text.secondary\">\n          Age: {cronJob.age}\n        </Typography>\n      }\n    />\n  )\n}\n"],"names":[],"mappings":"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"}